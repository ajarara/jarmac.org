<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>"setxkbmap madness"</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">No Odd Cycles </a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/misc.html">misc</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/setxkbmap-madness.html" rel="bookmark"
           title="Permalink to "setxkbmap madness"">"setxkbmap madness"</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-02-09T17:28:51-05:00">
                Published: Tue 09 February 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/ahmad-jarara.html">Ahmad Jarara</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info -->      <p>I recently came across an article off <a href="http://www.economyofeffort.com/2014/08/11/beyond-ctrl-remap-make-that-caps-lock-key-useful/">Economy of Effort</a> about keeping your pinky happy by swapping around caps lock with control. This is not new to most people, and is easy to do with <a href="https://pqrs.org/osx/karabiner/">Karabiner</a> for OS X. Unfortunately my last Macbook is back home, and also terribly, terribly old (if anyone else has the black 2006, you paid $200 extra for the paint job and some extra RAM, life is tough).</p>
<p>Running GNU/Linux, there are two main options to modifying your key layout: xmodmap and setxkbmap. Both are shipped with a standard Fedora installation, and the guide linked above uses setxkbmap. Unfortunately, I found that after sending my computer to sleep, caps lock reverted to its usual behavior, and I had to pop a terminal to source .profile. Alternatively, I could bind a key to source it, but I had three issues with that:</p>
<p>First, I would have to remember to press the key binding every time my laptop locked.</p>
<p>Second, if I forgot and I hit caps lock expecting control, I would have to hit caps lock before I hit the keybinding, otherwise it simply would not fire.</p>
<p>Third, .profile was in fact being sourced. I knew this because I used xev to look at the keycodes and found that the other relevant line in the guide was indeed being applied.</p>
<div class="highlight"><pre><span></span>xcape -e <span class="s1">&#39;Caps_Lock=Escape&#39;</span>
</pre></div>


<p>So setxkbmap was the culprit here. I tried figuring out a way to make it work, but found myself yearning for xmodmap's simple config. Yeah, it wasn't powerful, but it worked consistently. Here are the contents of my .xmodmap:</p>
<div class="highlight"><pre><span></span>!swapping caps to control
remove <span class="nv">Lock</span> <span class="o">=</span> Caps_Lock
remove <span class="nv">Control</span> <span class="o">=</span> Control_L
keysym <span class="nv">Control_L</span> <span class="o">=</span> Caps_Lock
keysym <span class="nv">Caps_Lock</span> <span class="o">=</span> Control_L
add <span class="nv">Lock</span> <span class="o">=</span> Caps_Lock
add <span class="nv">Control</span> <span class="o">=</span> Control_L
</pre></div>


<p>I couldn't get xcape to work with xmodmap until I realized that xcape was being called after xmodmap did its thing. This was enough to make me try the following in my .profile instead:</p>
<div class="highlight"><pre><span></span>xcape -e <span class="s1">&#39;Control_L=Escape&#39;</span>
</pre></div>


<p>And it worked. And man is it awesome on my pinky.</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>